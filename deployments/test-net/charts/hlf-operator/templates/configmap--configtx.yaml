apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "hlf-operator.fullname" . }}--configtx
  labels:
{{- include "labels.standard" . | nindent 4 }}
data:
  configtx.yaml: |
    Organizations:
      - &{{ .Values.addOrg.configtx.mspId }}
        # DefaultOrg defines the organization which is used in the sampleconfig
        # of the fabric.git development environment
        Name: {{ .Values.addOrg.configtx.mspId }}
        # ID to load the MSP definition as
        ID: {{ .Values.addOrg.configtx.mspId }}
        MSPDir: /var/hyperledger/crypto-config/{{ .Values.addOrg.configtx.mspId }}/msp
        Policies:
          Readers:
            Type: Signature
            Rule: "OR('{{ .Values.addOrg.configtx.mspId }}.admin', '{{ .Values.addOrg.configtx.mspId }}.peer', '{{ .Values.addOrg.configtx.mspId }}.client')"
          Writers:
            Type: Signature
            Rule: "OR('{{ .Values.addOrg.configtx.mspId }}.admin', '{{ .Values.addOrg.configtx.mspId }}.client')"
          Admins:
            Type: Signature
            Rule: "OR('{{ .Values.addOrg.configtx.mspId }}.admin')"
          Endorsement:
            Type: Signature
            Rule: "OR('{{ .Values.addOrg.configtx.mspId }}.peer')"
        AnchorPeers:
          # AnchorPeers defines the location of peers which can be used
          # for cross org gossip communication.  Note, this value is only
          # encoded in the genesis block in the Application section context
          - Host: {{ .Values.addOrg.configtx.anchorPeer }}
            Port: 7051
