cd {{{artifacts.local}}}/../../../packages/chaincode
# yarn install
yarn build

# Install chaincode 2.0
{{#orgs.peer}}
{{#peers.endpoints}}
docker exec cli{{network.host-delimiter}}{{domain}} sh -c "/setup/install_chaincode.sh {{domain}} {{-}} eventstore 2.0 {{port}} {{{admin-cert-path}}} {{{cert-path}}}"
docker exec cli{{network.host-delimiter}}{{domain}} sh -c "/setup/install_chaincode.sh {{domain}} {{-}} privatedata 2.0 {{port}} {{{admin-cert-path}}} {{{cert-path}}}"
{{/peers.endpoints}}
{{/orgs.peer}}

# Copy files to the container
cd ../../deployments/operations/upgradecc/scripts
mkdir -p {{{artifacts.local}}}/upgradecc
cp container/upgrade_chaincode_org1.sh {{{artifacts.local}}}/upgradecc

# Upgrade chaincode
docker exec cli{{network.host-delimiter}}{{orgs.peer.0.domain}} sh -c "/upgradecc/upgrade_chaincode_org1.sh"

# Invoke chaincode
{{#orgs.peer}}
sleep 5
docker exec cli{{network.host-delimiter}}{{domain}} sh -c "/setup/invoke_chaincode_{{script-naming}}.sh"
{{/orgs.peer}}